
(def slurp-fp (fn (fp)
 (def max-len 1000000000)
 (def s (c-call malloc * int max-len))
 (def read-bytes (c-call fread int * s int 1 int max-len * fp))
 (c-array-set char read-bytes s 0)
 (c-str s)))

(def slurp (fn (filename)
 ; todo checks
 (def fp (c-call fopen * * filename * 'r'))
 (def content (slurp-fp fp))
 (c-call fclose int * fp)
 content))

(def slurp-stdin (fn () (slurp-fp (c-array-get * 0 (c-val-ref stdin)))))

